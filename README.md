# FitnessHealthTracker

Додаток веб-API для відстеження активностей, харчування, показників здоров’я та цілей користувача.  
## Основній функціонал:
- Авторизація та автентифікація користувача (для надання доступу використовується JWT-токен);
- Робота з профілем користувача;
- Встановлення цілей користувача на певний період часу;
- Керування тренуваннями: створення, додавання завершених тренувань з відстеженням використаних калорій;
- Керування харчуванням: створення, додавання власних страв з можливістю вказати поживні речовини (білки, жири, вуглеводи, калорійність);
- Відстеження показників здоров'я;
- Статистика по користувачу за певний інтервал часу (або дату): використані калорії за тренуваннями, набуті калорії з харчуванням, загальні калорії за день.

В якості архітектури було обрано Clean Architecture, що надає можливості маштабування, тестованності та зручності розробки. Наприкінці опису наведено матеріали, за допомогою яких будувалася ця архітектура.
Система має реляційну базу даних MS SQL, схему наведено нижче:
<img width="875" height="830" alt="image" src="https://github.com/user-attachments/assets/079afd14-0ade-41a3-af3f-f39faba002b8" />
Опис сутностей:
- **Користувач** - має особисті дані (прізвище, ім'я, пошта), також має параметри (наприклад, дата народження, вік, можливе розширення)
- **Цілі** - є два види цілей: системні (має тільки назву, наприклад, "Скинути вагу") та користувацькі, тобто такі, які вже на основі системних цілей ставить собі користувач на певний період часу та з вказанням конкретного значення (наприклад, на скільки кілограм треба схуднути) та статусом (досягнуто чи ні)
- **Тренування** - також є два види: системні та користувальницьки, де користувач вказує пройдене тренування з системних, час тренування та кількість витрачених калорій
- **Страви** - можуть бути створені адміністратором, тоді будуть доступні всім користувачам, а також сам користувач може створювати власні страви. При створенні обов'язково вказуються поживні речовини (більки, жири, углеводи)  та калорійність на 100 грам страви
- **Прийоми їжі** - створюються користувачем з вибором страви, вказанням ваги порції та часу
- **Показники здоров'я** - будь-які з доступних видів показників (вага, зріст, пульс) зі вказанням дати та конкретного значення показника


Також система має логування (логи у файлі service{}.log, на кожний день створюються різні файли) за допомогою пакету Serilog, для керування користувачами використовується .NET Identity.
Для всіх сервісів додатку та їх методів було написано unit-тести. Для сервісу авторизації було опрацьовано всі можливі сценарії, а також для деяких важоивих методів інших сервісів.

### Для встановлення та налаштування додатку потрібно зробити наступні дії:
1. Скопіювати репозиторій на локальний комп'ютер;
2. Змінити назву Data Source на власний SQL сервер у файли ConfigureServices проекту Infrustructure (\FitnessHealthTracker\FitnessHealthTracker.Infrastructure\ConfigureServices.cs);
3. Провести міграції для створення БД: у Package Manager Console ввести наступну команду
   Update-Database -StartupProject FitnessHealthTracker.API -Project FitnessHealthTracker.Infrastructure
4. Запустити API-додаток за допомогою https.

### Обмеження додатку:
- При реєстрації пароль користувача повинен бути не менше 8 символів, містити малі та великі літери, цифри та знаки;
- Весь функціонал, окрім авторизації та реєстрації, доступний тільки для авторизованих користувачів, для чого потрібно ввести токен доступу, отриманий при авторизації;
- Після реєстрації потрібно авторизуватися;
- При додаванні страви можна вказати userId, тоді страва буде доступна тільки цьому користувачу.

### Подальший розвиток проекту
Проект потребує змін при подальшому розширенні. Наприклад, необхідна подальша нормалізація бази даних, можливо, додавання нових таблиць та окремих сутностей для різних показників здоров'я, додавання нових DTO для більш зручного використання API, розширення існуючих сутностей. 

### Опис доступних ендпоінтів та приклад даних для використання:


#### AuthController - авторизація та реєстрація

- **Шлях ендпоінту:** `POST /api/Auth/register`  
**Опис:** Реєстрація нового користувача
**Приклад запиту:**
```json
{
  "firstName": "Ivanov",
  "lastName": "Ivan",
  "email": "ivan@gmail.com",
  "password": "Ivan$123"
}
```

- **Шлях ендпоінту:** `POST /api/Auth/login`  
**Опис:** Авторизація користувача
**Приклад запиту:**
```json
{
  "email": "ivan@gmail.com",
  "password": "Ivan$123"
}
```

#### AimController - керування системними та користувальницькими цілями

- **Шлях ендпоінту:** `GET /api/Aim/all`  
**Опис:** Отримання списку всіх цілей (системних)

- **Шлях ендпоінту:** `POST /api/Aim`  
**Опис:** Додавання нової мети
**Приклад запиту:**
```json
{
  "name": "Lose weight",
  "description": "Lose some amount of weight"
}
```

- **Шлях ендпоінту:** `PUT /api/Aim`  
**Опис:** Оновлення мети
**Приклад запиту:**
```json
{
  "id": 1,
  "name": "Lose a lot of weight",
  "description": "Lose more than 10 kilo"
}
```

- **Шлях ендпоінту:** `DELETE /api/Aim/{aimId}`  
**Опис:** Видалення мети

- **Шлях ендпоінту:** `POST /api/Aim/user/add`  
**Опис:** Додавання нової мети користувача
**Приклад запиту:**
```json
{
  "aimId": 1,
  "startDate": "2025-08-08T12:39:45.108Z",
  "endDate": "2025-10-08T12:39:45.108Z",
  "aimValue": 15,
  "isAchieved": false
}
```

- **Шлях ендпоінту:** `PUT /api/Aim/user/update`  
**Опис:** Оновлення мети користувача
**Приклад запиту:**
```json
{
  "aimId": 1,
  "startDate": "2025-08-08T12:39:45.108Z",
  "endDate": "2025-10-15T12:39:45.108Z",
  "aimValue": 12,
  "isAchieved": false
}
```

- **Шлях ендпоінту:** `DELETE /api/Aim/user/{userAimId}`  
**Опис:** Видалення мети користувача

- **Шлях ендпоінту:** `GET /api/Aim/user`  
**Опис:** Отримання списку всіх цілей користувача

- **Шлях ендпоінту:** `PATCH /api/Aim/user/achieve/{userAimId}`  
**Опис:** Оновлення статусу мети на "досягнуто"

- **Шлях ендпоінту:** `GET /api/Aim/user/latest`  
**Опис:** Отримання останньою за датою мети користувача


#### ExerciseController - управління системними та користувальницькими тренуваннями


- **Шлях ендпоінту:** `GET /api/Exercise/all`  
**Опис:** Отримання списку всіх доступних вправ (системних)

- **Шлях ендпоінту:** `POST /api/Exercise`  
**Опис:** Додавання нової вправи
**Приклад запиту:**
```json
{
  "name": "Weightlifting"
}
```

- **Шлях ендпоінту:** `PUT /api/Exercise`  
**Опис:** Оновлення вправи
**Приклад запиту:**
```json
{
  "id": 1,
  "name": "Weightlifting less than 50 kilo"
}
```

- **Шлях ендпоінту:** `DELETE /api/Exercise/{exerciseId}`  
**Опис:** Видалення вправи

- **Шлях ендпоінту:** `POST /api/Exercise/user`  
**Опис:** Додавання нової вправи користувача (з тривалістю та витраченими калоріями)
**Приклад запиту:**
```json
{
  "exerciseId": 1,
  "startDate": "2025-08-08T13:06:53.093Z",
  "endDate": "2025-08-08T15:06:53.093Z",
  "calories": 450
}
```

- **Шлях ендпоінту:** `PUT /api/Exercise/user`  
**Опис:** Оновлення вправи користувача
**Приклад запиту:**
```json
{
  "id" : 1,
  "exerciseId": 1,
  "startDate": "2025-08-08T13:06:53.093Z",
  "endDate": "2025-08-08T15:06:53.093Z",
  "calories": 550
}
```

- **Шлях ендпоінту:** `DELETE /api/Exercise/user/{exerciseId}`  
**Опис:** Видалення вправи користувача
 
- **Шлях ендпоінту:** `GET /api/Exercise/user`  
**Опис:** Отримання списку всіх вправ користувача


#### HealthParametersController - керування показниками здоров'я користувача


- **Шлях ендпоінту:** `POST /api/HealthParameters`  
**Опис:** Додавання нового показника здоров'я
**Приклад запиту:**
```json
{
  "value": 90,
  "dateTime": "2025-08-08T13:12:24.033Z",
  "type": 0
}
```

- **Шлях ендпоінту:** `DELETE /api/HealthParameters/{parameterId}`  
**Опис:** Видалення показника здоров'я

- **Шлях ендпоінту:** `GET /api/HealthParameters/type`  
**Опис:** Отримання списку всіх показників користувача за типом показника

- **Шлях ендпоінту:** `GET /api/HealthParameters/interval`  
**Опис:** Отримання списку всіх показників користувача за певний інтервал часу


#### MealController - керування системними та користувальницькими стравами та їх поживними речовинами


- **Шлях ендпоінту:** `GET /api/Meal`  
**Опис:** Отримання списку всіх доступних страв (системних)

- **Шлях ендпоінту:** `POST /api/Meal`  
**Опис:** Додавання нової страви
**Приклад запиту:**
```json
{
  "name": "Fried chicken",
  "nutrientsId": 0,
  "nutrients": {
    "caloriesPerHundredGrams": 240,
    "proteinsPerHundredGrams": 50,
    "fatsPerHundredGrams": 20,
    "carbohydratesPerHundredGrams": 70
  }
}
```

- **Шлях ендпоінту:** `PUT /api/Meal`  
**Опис:** Оновлення страви
**Приклад запиту:**
```json
{
    "name": "Fried chicken nuggets",
    "id": 7
}
```

- **Шлях ендпоінту:** `GET /api/Meal/user`  
**Опис:** Отримання списку всіх страв, створених користувачем

- **Шлях ендпоінту:** `PATCH /api/Meal/{mealId}/nutrients`  
**Опис:** Оновлення поживних речовин страви
**Приклад запиту:**
```json
{
  "id": 1,
  "caloriesPerHundredGrams": 200,
  "proteinsPerHundredGrams": 10,
  "fatsPerHundredGrams": 30,
  "carbohydratesPerHundredGrams": 20
}
```

- **Шлях ендпоінту:** `DELETE /api/Meal/{mealId}`  
**Опис:** Видалення страви

- **Шлях ендпоінту:** `GET /api/Meal/history`  
**Опис:** Отримання списку всіх прийомів їжі користувачем

- **Шлях ендпоінту:** `POST /api/Meal/history`  
**Опис:** Додавання нового прийому їжі (страви) користувачем
**Приклад запиту:**
```json
{
  "mealId": 1,
  "date": "2025-08-08T13:23:59.858Z",
  "weightInGrams": 320
}
```

- **Шлях ендпоінту:** `PUT /api/Meal/history`  
**Опис:** Оновлення прийому їжі
**Приклад запиту:**
```json
{
  "id": 1,
  "mealId": 7,
  "date": "2025-08-08T13:24:45.405Z",
  "userId" : "{}",
  "weightInGrams": 400
}
```

- **Шлях ендпоінту:** `DELETE /api/Meal/history/{historyId}`  
**Опис:** Видалення прийому їжі


#### UserController - керування даними користувача


- **Шлях ендпоінту:** `GET /api/User/parameters`  
**Опис:** Отримання параметрів користувача

- **Шлях ендпоінту:** `PUT /api/User/parameters`  
**Опис:** Оновлення параметрів користувача
**Приклад запиту:**
```json
{
  "id": 1,
  "dateOfBirthday": "2000-08-08T13:32:34.460Z"
}
```

- **Шлях ендпоінту:** `GET /api/User/data`  
**Опис:** Отримання даних користувача

- **Шлях ендпоінту:** `PUT /api/User/data`  
**Опис:** Оновлення даних користувача
**Приклад запиту:**
```json
{
  "id": "{}",
  "firstName": "Ivanov",
  "lastName": "Nikita",
  "email": "ivan@gmail.com"
}
```

#### UserStatisticsController - отримання статистики по калоріям, тренуванням та прийомам їжі


- **Шлях ендпоінту:** `GET /api/UserStatistics/TotalCaloriesPerMealDate`  
**Опис:** Отримання даних про прийоми їжі з розрахунком калорійності за певну дату або інтервал часу

- **Шлях ендпоінту:** `GET /api/UserStatistics/TotalCaloriesPerActivityDate`  
**Опис:** Отримання даних про тренування з розрахунком калорійності за певну дату або інтервал часу

- **Шлях ендпоінту:** `GET /api/UserStatistics/TotalCaloriesPerDate`  
**Опис:** Отримання даних про прийоми їжі та тренування з розрахунком калорійності за певну дату або інтервал часу

### Використана література та приклади:
- https://github.com/nhonvo/clean-architecture-net-8.0
- https://www.c-sharpcorner.com/article/how-to-build-a-clean-architecture-web-api-with-net-core-8/
- https://antondevtips.com/blog/logging-best-practices-in-asp-net-core



